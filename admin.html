<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard - Vishwakarma Matrimony</title>
    <style>
        body {
            font-family: Arial;
            padding: 30px;
            background-color: #f4f4f4;
        }
        .box {
            background: white;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.2);
        }
        button {
            padding: 10px;
            background: maroon;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background: darkred;
        }
    </style>
</head>
<body>
<button id="logoutBtn" style="
  position: absolute;
  top: 20px;
  right: 20px;
  padding: 8px 15px;
  background: maroon;
  color: white;
  border: none;
  cursor: pointer;
">
  Logout
</button>
<div class="box">
    <h2>Admin Dashboard</h2>
    <p>Welcome Admin ðŸ‘‹</p>
    <hr>
<h3>All Profiles</h3>
    <div style="margin-bottom:20px;">
  <input type="text" id="searchInput" placeholder="Search by name..." 
    style="padding:8px;width:200px;margin-right:10px;">
    
  <select id="typeFilter" style="padding:8px;margin-right:10px;">
    <option value="">All Types</option>
    <option value="bride">Bride</option>
    <option value="groom">Groom</option>
  </select>

  <select id="stateFilter" style="padding:8px;">
    <option value="">All States</option>
  </select>
</div>
<div id="profilesContainer"></div>
    <button onclick="logout()">Logout</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyAyT4AF8qZMyvqZNC8hGanMvGSwfydTDJU",
  authDomain: "vishwakarmamarriage-e8e13.firebaseapp.com",
  projectId: "vishwakarmamarriage-e8e13",
  storageBucket: "vishwakarmamarriage-e8e13.firebasestorage.app",
  messagingSenderId: "287592386640",
  appId: "1:287592386640:web:93a60b14daf415eac3c155",
  measurementId: "G-ZRZV7KSB8Z"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
    // Load profiles
async function loadProfiles() {
  try {
    const response = await fetch("profiles.json");
    const profiles = await response.json();
const stateSet = new Set();
    profiles.forEach(p => stateSet.add(p.state));

    const stateFilter = document.getElementById("stateFilter");
    stateFilter.innerHTML = '<option value="">All States</option>';

    stateSet.forEach(state => {
      const option = document.createElement("option");
      option.value = state;
      option.textContent = state;
      stateFilter.appendChild(option);
    });
    const container = document.getElementById("profilesContainer");
    container.innerHTML = "";
    const searchValue = document.getElementById("searchInput").value.toLowerCase();
      const selectedType = document.getElementById("typeFilter").value;
const selectedState = document.getElementById("stateFilter").value;

profiles
  .filter(profile =>
    profile.name.toLowerCase().includes(searchValue) &&
    (selectedType === "" || profile.type === selectedType) &&
    (selectedState === "" || profile.state === selectedState)
  )
  .forEach((profile, index) => {
      const div = document.createElement("div");
      div.style.border = "1px solid #ccc";
      div.style.padding = "10px";
      div.style.marginBottom = "10px";

     div.innerHTML = `
  <img src="${profile.photo}" width="100"><br>
  <strong>${profile.name}</strong><br>
  Age: ${profile.age}<br>
  Location: ${profile.district}, ${profile.state}<br>
  Type: ${profile.type}<br>
  Category: ${profile.category}
`;
      container.appendChild(div);
    });

  } catch (error) {
    console.error("Error loading profiles:", error);
  }
}
window.deleteProfile = function(index) {
  if (confirm("Are you sure you want to delete this profile?")) {
    const cards = document.querySelectorAll("#profilesContainer > div");
    cards[index].remove();
  }
};
// Protect page
onAuthStateChanged(auth, (user) => {
  if (!user) {
    window.location.href = "login.html";
  } else {
    if (user.email !== "vishwakarmamarriage.in@gmail.com") {
      alert("Access Denied");
      signOut(auth);
      window.location.href = "login.html";
    } else {
      loadProfiles();   // ðŸ‘ˆ Add this line
    }
  }
});
</script>
</body>
</html>
